# <font style="color:rgb(0,0,0);"> 简介 </font>
<font style="color:rgb(0,0,0);">Python 标准库是随 Python 附带安装的，它包含大量极其有用的模块。熟悉Python 标准库是十分重要的，因为如果你熟悉这些库中的模块，那么你的大多数问题都可以简单快捷地使用它们来解决。 </font>

<font style="color:rgb(0,0,0);">我们将会研究一些这个库中的常用模块。你可以在 Python 附带安装的文档的</font><font style="color:rgb(0,191,191);">“</font>[库参考](https://docs.python.org/3/library/)<font style="color:rgb(0,191,191);">”</font><font style="color:rgb(0,0,0);">一节中了解 Python 标准库中所有模块的完整内容。让我们来研究一些有用的模块。 </font>

# <font style="color:rgb(0,0,0);"> sys 模块 </font>
<font style="color:rgb(0,0,0);">sys 模块包含了系统指定的函数功能。我们已经看到 sys.argv 列表包含命令行参数。 </font>

<font style="color:rgb(0,0,0);">设想我们想要查看我们所使用 Python 命令行的版本，也就是说，我们想要保证我们正在使用的 Python 版本至少为 3。sys 模块给我们这样的功能。 </font>

```python
>>> import sys
>>> sys.version_info
sys.version_info(major=3, minor=6, micro=0, releaselevel='final', serial=0)
>>> sys.version_info.major == 3
True
```

<font style="color:rgb(0,0,0);">如何工作： </font>

<font style="color:rgb(0,0,0);">sys 模块有一个 version_info 元组，它能给出版本的信息。第一个是主要的版本号。我们可以来检查这一条来保证程序运行在 Python3.0 或以上。 </font>

```python
#!/usr/bin/python 
# Filename: versioncheck.py 

import sys, warnings 

if sys.version_info[0] < 3: 
    warnings.warn("Need Python 3.0 for this program to run", RuntimeWarning) 
else:  
    print('Proceed as normal') 
```

<font style="color:rgb(0,0,0);">输出： </font>

```python
$ python2.5 versioncheck.py 
versioncheck.py:6: RuntimeWarning: Need Python 3.0 for this program to run RuntimeWarning) 
                                                   $ python3 versioncheck.py 
                                                   Proceed as normal 
```

<font style="color:rgb(0,0,0);">如何工作： </font>

<font style="color:rgb(0,0,0);">我们使用了标准库中的另一个叫做 warning 的模块，来给最终用户显示警告信息。如果 Python 版本号少于 3，我们我们显示相应的警告。 </font>

# <font style="color:rgb(0,0,0);">logging 模块 </font>
<font style="color:rgb(0,0,0);">如果你想得到一些调试信息或重要信息并将其存储在某个地方，用来检查你的程序程序运行是否是你期望的那样，该怎么做呢？如何处理存储在某处的这些信息呢？ </font>

<font style="color:rgb(0,0,0);">可以用 logging 模块来实现。 </font>

```python
# !/usr/bin/python 
# Filename: use_logging.py 
import os
import platform
import logging

if platform.platform().startswith('Windows'):
    logging_file = os.path.join(os.getenv('HOMEDRIVE'),
                                os.getenv('HOMEPATH'),
                                'test.log')
else:
    logging_file = os.path.join(os.getenv('HOME'),
                                'test.log')

print("Logging to", logging_file)

logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s : %(levelname)s : %(message)s',
    filename=logging_file,
    filemode='w',
)

logging.debug("Start of the program")
logging.info("Doing something")
logging.warning("Dying now")
```

<font style="color:rgb(0,0,0);">输出： </font>

```python
$ python use_logging.py
Logging to /Users/swa/test.log

$ cat /Users/swa/test.log
2014-03-29 09:27:36,660 : DEBUG : Start of the program
2014-03-29 09:27:36,660 : INFO : Doing something
2014-03-29 09:27:36,660 : WARNING : Dying now
```

<font style="color:rgb(0,0,0);">如何工作： </font>

<font style="color:rgb(0,0,0);">我们使用了标准库中的三个模块 ——os 模块用来和操作系统交互，platform 模块用来得到平台的信息，例如像操作系统平台，logging 模块用来记录信息。 </font>

<font style="color:rgb(0,0,0);">首先，我们用 platform.platform()（更多信息，查看 import platform;help(platform)） 返回的字符串来检查操作系统的类型。如果是 windows，我们取出主盘符，主文件夹和要存储信息的文件名。将这些信息放在一起，就得到了文件的完整地位置。对于其他平台，我们只需要知道用户的主文件夹，然后得到文件的完整位置。 </font>

<font style="color:rgb(0,0,0);">我们使用 os.path.join() 函数将这三部分放在一起。我们使用专门的函数而不是仅仅将三个字符串相加是因为函数能保证得到操作系统对应的文件位置格式。我们配置logging 模块来将所有的信息以特定的格式写入指定的文件中。 </font>

<font style="color:rgb(0,0,0);">最后，可以放入信息，可以是关于调试，通知，警告或者是临界消息。一旦程序运行，我们可以检查这个文件，了解到程序中发生了什么情况，尽管运行的程序没有任何信息显示给用户。 </font>

# <font style="color:rgb(0,0,0);">urllib 和 json 模块 </font>
<font style="color:rgb(0,0,0);">如果你写的程序能得到从网页中的搜索结果，那会多么令人兴奋。现在就让我们做一番探索。 </font>

<font style="color:rgb(0,0,0);">这可以用一些模块来实现。首先就是 urllib 模块，他可以用来从 internet 上取来一些网页。我们将使用 Yahoo！搜索引擎来得到搜索结果，它们能给出叫做 JSON 格式的结果，我们就能很容易用在标准库中内建的模块来解析。 </font>

<font style="color:rgb(0,0,0);">要做的事： </font>

<font style="color:rgb(0,0,0);">这个程序还不能工作，这似乎是 Python 3.0 beta 2 的一个 bug(</font>[https://bugs.python.org/issue3763](https://bugs.python.org/issue3763)<font style="color:rgb(0,0,0);">)。 </font>

```python
#!/usr/bin/python 
# Filename: yahoo_search.py 

import sys 

if sys.version_info[0] != 3: 
    sys.exit('This program needs Python 3.0') 

import json 
import urllib, urllib.parse, urllib.request, urllib.response 

#Get your own APP ID at http://developer.yahoo.com/wsregapp/ 

YAHOO_APP_ID = ' 
jl22psvV34HELWhdfUJbfDQzlJ2B57KFS_qs4I8D0Wz5U5_yCI1Awv8.lBSfPhwr 
' 

SEARCH_BASE = 'http://search.yahooapis.com/WebSearchService/V1/ 
webSearch' 

class YahooSearchError(Exception): 
    pass 

# Taken from http://developer.yahoo.com/python/python-json.html 
def search(query, results=20, start=1,**kwargs): 
    kwargs.update({ 
        'appid':YAHOO_APP_ID, 
        'query':query, 
        'results':results, 
        'start':start, 
        'output':'json', 
    }) 

url = SEARCH_BASE + '?' + urllib.parse.urlencode(kwargs) 
result = json.load(urllib.request.urlopen(url)) 

if 'Error' in result: 
    raise YahooSearchError(result['Error']) 
return result['ResultSet'] 

query = input('What do you want to search for?') 

for result in search(query)['Result']: 
    print("{0}:{1}".format(result['Title'], result['Url'])) 
```

<font style="color:rgb(0,0,0);">输出： </font>

<font style="color:rgb(0,0,0);">要做的事： </font>

<font style="color:rgb(0,0,0);">如何工作： </font>

<font style="color:rgb(0,0,0);">我们可以通过给出我们要搜索的特殊格式的文本从特殊的网站得到搜索结果。我们必须指定许多选项，我们用 key1 = value1 & key2 = value2 格式表示，这就可以用 urllib.parse.urlencode() 函数处理。 </font>

<font style="color:rgb(0,0,0);">例如，在你的浏览器中打开</font>[这个链接](http://search.yahooapis.com/%20WebSearchService/V1/webSearch?query=byte+of+python&appid=jl22psvV3%204HELWhdfUJbfDQzlJ2B57KFS_qs4I8D0Wz5U5_yCI1Awv8.lBSfPhwr&results=20&%20start=1&output=json)<font style="color:rgb(0,0,0);">，你会得到 20 个结果，从第一个结果"byte of python"，我们要求的输出结果是 JSON 格式的。 </font>

<font style="color:rgb(0,0,0);">我们用 urllib.request.urlopen() 函数连接到这个 URL ，将文件句柄传递给 json.load() ，它会读取其中的内容，同时转换为 Python 对象。然后在这些结果上一次次循环，将其展示给终端用户。 </font>

# <font style="color:rgb(0,0,0);"> Week 系列模块 </font>
<font style="color:rgb(0,0,0);">在标准库中还有很多值得探究，如调试，命令行选项处理，正则表达式得等。 </font>

<font style="color:rgb(0,0,0);">进一步探究标准库最好的方式是阅读 </font>[https://doughellmann.com/projects/pymotw/](https://doughellmann.com/projects/pymotw/)<font style="color:rgb(0,0,0);">。 </font>

<font style="color:rgb(51, 51, 51);">There is much more to be explored in the standard library such as </font>[pdb — The Python Debugger](http://docs.python.org/3/library/pdb.html)<font style="color:rgb(51, 51, 51);">, </font>[handling command line options](http://docs.python.org/3/library/argparse.html)<font style="color:rgb(51, 51, 51);">, </font>[regular expressions](http://docs.python.org/3/library/re.html)<font style="color:rgb(51, 51, 51);"> and so on.</font>

<font style="color:rgb(51, 51, 51);">The best way to further explore the standard library is to read Doug Hellmann's excellent </font>[Python Module of the Week - Python Module of the Week](http://pymotw.com/2/contents.html)<font style="color:rgb(51, 51, 51);"> series (also available as a </font>[<font style="color:rgb(51, 51, 51);">book</font>](http://amzn.com/0321767349)<font style="color:rgb(51, 51, 51);">) and reading the </font>[<font style="color:rgb(51, 51, 51);">Python documentation</font>](http://docs.python.org/3/)<font style="color:rgb(51, 51, 51);">.</font>

# <font style="color:rgb(0,0,0);"> 概括 </font>
<font style="color:rgb(0,0,0);">我们已经探究了在 Python 标准库中的许多模块的一些功能。强烈建议你浏览</font>[Python 标准库文档](https://docs.python.org/3/library/)<font style="color:rgb(0,0,0);">来得到所有模块的概念。 </font>

<font style="color:rgb(0,0,0);">接下来，我们会覆盖 Python 的各个方面，让我们的 Python 之旅更加完整。 </font>



