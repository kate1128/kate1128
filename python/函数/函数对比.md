<font style="color:rgb(0, 0, 0);">以下是 Python 函数与 Go 函数的详细对比说明，包含 Python 函数的定义方式、参数处理、作用域等核心特性，以及与 Go 的区别：</font>

# <font style="color:rgb(0, 0, 0);"> 函数定义与调用</font>
## <font style="color:rgb(0, 0, 0);">基础函数定义</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

```python
# 无参数，无返回值
def greet():
    print("Hello!")

# 带参数，有返回值
def add(a, b):
    return a + b

# 调用函数
greet()          # 输出: Hello!
result = add(3, 5)  # result = 8
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
// 无参数，无返回值
func greet() {
    fmt.Println("Hello!")
}

// 带参数，有返回值
func add(a int, b int) int {
    return a + b
}

// 调用
greet()          // 输出: Hello!
result := add(3, 5) // result = 8
```

**<font style="color:rgb(0, 0, 0);">核心差异</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ **<font style="color:#DF2A3F;">Python 无需声明参数和返回值类型，Go 必须显式声明</font>**
+ <font style="color:rgb(0, 0, 0);">Python 用 </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">def</font>`<font style="color:rgb(0, 0, 0);"> 定义函数，Go 用 </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">func</font>`

# <font style="color:rgb(0, 0, 0);">参数处理</font>
## <font style="color:rgb(0, 0, 0);">默认参数</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

```python
def power(base, exponent=2):
    return base ** exponent

print(power(3))     # 输出 9 (3^2)
print(power(2, 4))  # 输出 16 (2^4)
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ **<font style="color:rgb(0, 0, 0);">不支持默认参数，需通过结构体或可选参数模式实现</font>**

```go
type PowerOptions struct {
    Exponent int
}

func Power(base int, opts PowerOptions) int {
    exponent := opts.Exponent
    if exponent == 0 {
        exponent = 2 // 默认值
    }
    return int(math.Pow(float64(base), float64(exponent)))
}

// 调用
result := Power(3, PowerOptions{})          // 9
result := Power(2, PowerOptions{Exponent:4}) // 16
```

## <font style="color:rgb(0, 0, 0);">可变参数</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:#DF2A3F;">python 的可变参数也没有类型定义，所以可以传任意类型？</font>

```python
def sum_all(*args):
    total = 0
    for num in args:
        total += num
    return total

print(sum_all(1, 2, 3))  # 输出 6
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
func SumAll(nums ...int) int {
    total := 0
    for _, num := range nums {
        total += num
    }
    return total
}

// 调用
result := SumAll(1, 2, 3)  // 6
```

**<font style="color:rgb(0, 0, 0);">差异</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ **<font style="color:#DF2A3F;">Python 使用 </font>**`**<font style="color:#DF2A3F;background-color:rgba(27, 31, 35, 0.05);">*args</font>**`**<font style="color:#DF2A3F;"> 收集位置参数为元组</font>**
+ <font style="color:rgb(0, 0, 0);">Go 使用 </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">...T</font>`<font style="color:rgb(0, 0, 0);"> 语法表示可变参数（类型必须一致）</font>

## <font style="color:rgb(0, 0, 0);">关键字参数</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:rgb(0, 0, 0);">不用结构体，直接</font>`<font style="color:rgb(0, 0, 0);">字段名=xx</font>`<font style="color:rgb(0, 0, 0);">就传参了</font>

```python
def create_user(name, age, email=""):
    print(f"{name}, {age}岁, 邮箱: {email}")

# 关键字参数调用（顺序无关）
create_user(age=25, name="Alice", email="alice@example.com")
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ <font style="color:rgb(0, 0, 0);">不支持关键字参数，需通过结构体传递</font>

```go
type UserParams struct {
    Name  string
    Age   int
    Email string
}

func CreateUser(params UserParams) {
    fmt.Printf("%s, %d岁, 邮箱: %s", params.Name, params.Age, params.Email)
}

// 调用
CreateUser(UserParams{
    Name:  "Alice",
    Age:   25,
    Email: "alice@example.com",
})
```

# <font style="color:rgb(0, 0, 0);">三、返回值处理</font>
## <font style="color:rgb(0, 0, 0);">多返回值</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:#DF2A3F;">所以也不用定义返回值类型，爱返回什么就返回什么？</font>

```python
def divide(a, b):
    if b == 0:
        return None, "除数不能为零"
    return a / b, None

result, err = divide(10, 2)  # result=5.0, err=None
result, err = divide(5, 0)   # result=None, err="除数不能为零"
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
func Divide(a, b float64) (float64, error) {
    if b == 0 {
        return 0, errors.New("除数不能为零")
    }
    return a / b, nil
}

// 调用
result, err := Divide(10, 2)
result, err := Divide(5, 0)
```

**<font style="color:rgb(0, 0, 0);">差异</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ **<font style="color:#DF2A3F;">Python 用元组返回多个值</font>**<font style="color:rgb(0, 0, 0);">，Go 显式声明返回类型</font>
+ <font style="color:rgb(0, 0, 0);">Go 的 </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">error</font>`<font style="color:rgb(0, 0, 0);"> 类型是官方推荐的错误处理方式</font>

## <font style="color:rgb(0, 0, 0);">函数作为返回值</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:#DF2A3F;">这个语法真怪，def 里还能嵌套 def?</font>

```python
def make_adder(n):
    def adder(x):
        return x + n
    return adder

add5 = make_adder(5)
print(add5(3))  # 输出 8
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
func MakeAdder(n int) func(int) int {
    return func(x int) int {
        return x + n
    }
}

// 调用
add5 := MakeAdder(5)
result := add5(3) // 8
```

# <font style="color:rgb(0, 0, 0);">作用域与闭包</font>
## <font style="color:rgb(0, 0, 0);">变量作用域</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:rgb(0, 0, 0);">所以加上 global 就能修改全局变量了</font>

```python
x = 10  # 全局变量

def modify():
    global x  # 声明使用全局变量
    x = 20

modify()
print(x)  # 输出 20
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
var x int = 10 // 包级变量

func Modify() {
    x = 20 // 直接修改包级变量
}

func main() {
    Modify()
    fmt.Println(x) // 20
}
```

**<font style="color:rgb(0, 0, 0);">差异</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ **<font style="color:#DF2A3F;">Python 需要 </font>**`**<font style="color:#DF2A3F;background-color:rgba(27, 31, 35, 0.05);">global</font>**`**<font style="color:#DF2A3F;"> 关键字修改全局变量</font>**
+ <font style="color:rgb(0, 0, 0);">Go 的包级变量可直接修改（需注意并发安全）</font>

## <font style="color:rgb(0, 0, 0);">闭包特性</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:#DF2A3F;">def 套 def，加上</font>`<font style="color:#DF2A3F;background-color:rgba(27, 31, 35, 0.05);">nonlocal</font>`<font style="color:#DF2A3F;"> 就能修改外层变量了</font>

```python
def counter():
    count = 0
    def inc():
        nonlocal count  # 声明使用外层变量
        count += 1
        return count
    return inc

c = counter()
print(c(), c(), c())  # 输出 1, 2, 3
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
func Counter() func() int {
    count := 0
    return func() int {
        count++
        return count
    }
}

// 调用
c := Counter()
fmt.Println(c(), c(), c()) // 1, 2, 3
```

**<font style="color:rgb(0, 0, 0);">差异</font>**<font style="color:rgb(0, 0, 0);">：</font>

+ <font style="color:rgb(0, 0, 0);">Python 需要</font><font style="color:rgb(0, 0, 0);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">nonlocal</font>`<font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">关键字修改外层变量</font>
+ <font style="color:rgb(0, 0, 0);">Go 自动捕获闭包变量</font>

# <font style="color:rgb(0, 0, 0);">匿名函数</font>
## <font style="color:rgb(0, 0, 0);">Lambda 函数</font>
**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

<font style="color:#DF2A3F;">看不懂，两个星号什么意思？</font>

```python
# 单表达式匿名函数
square = lambda x: x ** 2
print(square(4))  # 输出 16

# 作为参数传递
numbers = [1, 2, 3]
squared = list(map(lambda x: x**2, numbers))  # [1, 4, 9]
```

**<font style="color:rgb(0, 0, 0);">Go</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
// 匿名函数
square := func(x int) int { return x * x }
fmt.Println(square(4)) // 16

// 作为参数传递
numbers := []int{1, 2, 3}
squared := make([]int, len(numbers))
for i, x := range numbers {
    squared[i] = func(n int) int { return n * n }(x)
}
// 或使用闭包
```

# <font style="color:rgb(0, 0, 0);">装饰器（Python 特有）</font>
## <font style="color:rgb(0, 0, 0);">函数装饰器</font>
<font style="color:#DF2A3F;">装饰器是什么？</font><font style="color:rgb(0, 0, 0);">把 def 给另一个 def 上带个</font>`<font style="color:rgb(0, 0, 0);">@</font>`<font style="color:rgb(0, 0, 0);">符号？</font>

**<font style="color:rgb(0, 0, 0);">Python</font>**<font style="color:rgb(0, 0, 0);">：</font>

```python
def log_time(func):
    def wrapper(*args, **kwargs):
        start = time.time()
        result = func(*args, **kwargs)
        print(f"耗时: {time.time() - start:.2f}秒")
        return result
    return wrapper

@log_time
def heavy_task():
    time.sleep(1)

heavy_task()  # 输出耗时
```

**<font style="color:rgb(0, 0, 0);">Go 类似实现</font>**<font style="color:rgb(0, 0, 0);">：</font>

```go
func LogTime(f func()) func() {
    return func() {
        start := time.Now()
        f()
        fmt.Printf("耗时: %v\n", time.Since(start))
    }
}

func HeavyTask() {
    time.Sleep(1 * time.Second)
}

// 调用
decorated := LogTime(HeavyTask)
decorated()
```

# <font style="color:rgb(0, 0, 0);">错误处理对比</font>
## <font style="color:rgb(0, 0, 0);">Python 异常处理</font>
```python
def read_file(path):
    try:
        with open(path) as f:
            return f.read()
    except FileNotFoundError:
        print("文件不存在")
    except Exception as e:
        print(f"未知错误: {e}")

content = read_file("test.txt")
```

## <font style="color:rgb(0, 0, 0);">Go 错误返回值</font>
```go
func ReadFile(path string) (string, error) {
    data, err := os.ReadFile(path)
    if errors.Is(err, os.ErrNotExist) {
        fmt.Println("文件不存在")
        return "", err
    } else if err != nil {
        fmt.Printf("未知错误: %v", err)
        return "", err
    }
    return string(data), nil
}

// 调用
content, err := ReadFile("test.txt")
```

# <font style="color:rgb(0, 0, 0);">核心差异总结表</font>
| **<font style="color:rgb(0, 0, 0);">特性</font>** | **<font style="color:rgb(0, 0, 0);">Python 实现</font>** | **<font style="color:rgb(0, 0, 0);">Go 实现</font>** | **<font style="color:rgb(0, 0, 0);">关键差异</font>** |
| :--- | :--- | :--- | :--- |
| **<font style="color:rgb(0, 0, 0);">参数类型</font>** | <font style="color:rgb(0, 0, 0);">动态类型，无需声明</font> | <font style="color:rgb(0, 0, 0);">必须显式声明类型</font> | <font style="color:rgb(0, 0, 0);">Python 更灵活，Go 更安全</font> |
| **<font style="color:rgb(0, 0, 0);">默认参数</font>** | <font style="color:rgb(0, 0, 0);">直接支持</font> | <font style="color:rgb(0, 0, 0);">通过结构体/可选参数模式模拟</font> | <font style="color:rgb(0, 0, 0);">Python 语法更简洁</font> |
| **<font style="color:rgb(0, 0, 0);">可变参数</font>** | `<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">*args</font>`<br/><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">接收元组</font> | `<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">...T</font>`<br/><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">语法</font> | <font style="color:rgb(0, 0, 0);">Python 可混合类型，Go 需类型一致</font> |
| **<font style="color:rgb(0, 0, 0);">多返回值</font>** | <font style="color:rgb(0, 0, 0);">返回元组</font> | <font style="color:rgb(0, 0, 0);">显式声明返回类型</font> | <font style="color:rgb(0, 0, 0);">Go 官方推荐用</font><font style="color:rgb(0, 0, 0);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">(T, error)</font>`<br/><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">模式</font> |
| **<font style="color:rgb(0, 0, 0);">错误处理</font>** | <font style="color:rgb(0, 0, 0);">异常机制 (</font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">try/except</font>`<br/><font style="color:rgb(0, 0, 0);">)</font> | <font style="color:rgb(0, 0, 0);">显式错误返回值</font> | <font style="color:rgb(0, 0, 0);">Python 适合集中处理，Go 强制逐级检查</font> |
| **<font style="color:rgb(0, 0, 0);">匿名函数</font>** | `<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">lambda</font>`<br/><font style="color:rgb(0, 0, 0);">（单表达式）</font> | <font style="color:rgb(0, 0, 0);">完整闭包支持</font> | <font style="color:rgb(0, 0, 0);">Go 的匿名函数更强大</font> |
| **<font style="color:rgb(0, 0, 0);">装饰器</font>** | `<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">@</font>`<br/><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">语法糖</font> | <font style="color:rgb(0, 0, 0);">函数包装模式</font> | <font style="color:rgb(0, 0, 0);">Python 装饰器是重要语言特性</font> |
| **<font style="color:rgb(0, 0, 0);">作用域修改</font>** | `<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">global</font>`<br/><font style="color:rgb(0, 0, 0);">/</font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">nonlocal</font>`<br/><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">关键字</font> | <font style="color:rgb(0, 0, 0);">直接访问包级变量或闭包捕获</font> | <font style="color:rgb(0, 0, 0);">Go 的闭包捕获更自动化</font> |


# <font style="color:rgb(0, 0, 0);">Python 函数高级用法</font>
## <font style="color:rgb(0, 0, 0);">类型提示（Python 3.5+）</font>
<font style="color:#DF2A3F;">是说这个箭头是类型提示？</font>

```python
from typing import Optional

def greeting(name: str, times: int = 1) -> str:
    """返回重复的问候语"""
    return "Hello " * times + name

result: str = greeting("Alice", 2)
```

## <font style="color:rgb(0, 0, 0);">生成器函数</font>
<font style="color:#DF2A3F;">yield 什么意思？</font>

```python
def count_down(n):
    while n > 0:
        yield n
n -= 1

# 使用生成器
for num in count_down(5):
    print(num)  # 输出 5,4,3,2,1
```

# <font style="color:rgb(0, 0, 0);">开发建议</font>
1. **<font style="color:rgb(0, 0, 0);">参数设计</font>**<font style="color:rgb(0, 0, 0);">：</font>
    - <font style="color:rgb(0, 0, 0);">Python 优先使用关键字参数提高可读性</font>
    - <font style="color:#DF2A3F;">所以 python 也可以定义数据类型，用冒号定义的</font>

```python
def connect(host: str, port: int, timeout: float = 5.0):
    ...

connect(host="localhost", port=8080)
```

2. **<font style="color:rgb(0, 0, 0);">错误处理</font>**<font style="color:rgb(0, 0, 0);">：</font>
    - <font style="color:rgb(0, 0, 0);">Python 避免过度使用宽泛的</font><font style="color:rgb(0, 0, 0);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">except:</font>`
    - <font style="color:#DF2A3F;background-color:rgba(27, 31, 35, 0.05);">raise 和 panic 差不多</font>

```python
try:
    risky_operation()
except ValueError:
    # 处理已知错误
    except Exception as e:
        logger.exception("未预料的错误")
        raise
```

3. **<font style="color:rgb(0, 0, 0);">性能优化</font>**<font style="color:rgb(0, 0, 0);">：</font>
    - <font style="color:rgb(0, 0, 0);">对于频繁调用的小函数，使用</font><font style="color:rgb(0, 0, 0);"> </font>`<font style="color:rgb(0, 0, 0);background-color:rgba(27, 31, 35, 0.05);">functools.lru_cache</font>`<font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">缓存结果</font>
    - <font style="color:#DF2A3F;">结果还能缓存？</font>

```python
from functools import lru_cache

@lru_cache(maxsize=128)
def factorial(n: int) -> int:
    return 1 if n < 2 else n * factorial(n-1)
```

